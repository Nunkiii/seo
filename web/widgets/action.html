
<style>

</style>

<div>

  <button data-var="b" type="button" class="btn btn-primary">
    Action
  </button>

  <output data-var="ci">
    unknown
  </output>

</div>

<script class="builder">

var a=this;

var button_handler;

a.b.disabled=true;

$(this.b).on("click", function(){
    if(button_handler!==undefined)
	button_handler();
});
 
this.wait=function(cfg ){
    $(a.ci).html("waiting...")
        .removeClass()
        .addClass("text-warning");
    $(a.b).html("Waiting")
        .removeClass()
        .addClass("btn btn-warning");

    if(cfg.message!==undefined)
	$(a.ci).append(" "+cfg.message);
    
    if(cfg.button_message!==undefined){
 	$(a.b).prop("disabled",false);
	$(a.b).append(" "+cfg.button_message);
    }else{
 	$(a.b).prop("disabled",true);
    }
    
    if(cfg.wait_cb!==undefined){
 	$(a.b).prop("disabled",false);
	button_handler=cfg.wait_cb;
    }else{
 	$(a.b).prop("disabled",true);
    }
}

this.start=function(cfg){
    
    if(cfg.message!==undefined)
    $(a.ci).html(cfg.message)
        .removeClass()
        .addClass("text-success");
    if(cfg.button_message!==undefined){
 	$(a.b).prop("disabled",false);
	$(a.b).html(cfg.button_message)
        .removeClass()
        .addClass("btn btn-success");
    }else{
 	$(a.b).prop("disabled",true);
    }
    
    if(cfg.start_cb!==undefined){
 	$(a.b).prop("disabled",false);
	button_handler=cfg.start_cb;
    }else{
 	$(a.b).prop("disabled",true);
    }
    
}

this.error=function(cfg){
    $(a.ci).html("error")
        .removeClass()
        .addClass("text-danger");
    $(a.b).html("Error")
        .removeClass()
        .addClass("btn btn-danger");        
    
    if(cfg.message!==undefined)
	$(a.ci).append(" "+cfg.message);
    
    if(cfg.button_message!==undefined){
 	$(a.b).prop("disabled",false);
	$(a.b).append(" "+cfg.button_message);
    }else{
 	$(a.b).prop("disabled",true);
    }
    
    if(cfg.error_cb!==undefined){
 	$(a.b).prop("disabled",false);
	button_handler=cfg.wait_cb;
    }else{
 	$(a.b).prop("disabled",true);
    }
    
}

</script>
